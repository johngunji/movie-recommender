<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Movie Recommender</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
<div class="container py-5">
<h1 class="text-center gradient-text mb-4">ðŸŽ¬ Movie Recommender</h1>

<div class="search-card p-4 mb-5">
<div class="row g-3">
<input id="movie" class="form-control" placeholder="Enter a movie you liked">
<select id="type" class="form-select">
<option value="">All</option>
<option value="movie">Movies</option>
<option value="tv show">TV Shows</option>
</select>
<select id="language" class="form-select">
<option value="">All</option>
<option value="english">English</option>
<option value="hindi">Hindi</option>
<option value="telugu">Telugu</option>
</select>
<select id="platform" class="form-select">
<option value="">All Platforms</option>
<option value="Netflix / Disney">Netflix / Disney</option>
<option value="Prime Video">Prime Video</option>
</select>
<button onclick="go()" class="btn btn-danger">Recommend</button>
</div>
</div>

<div id="results" class="row row-cols-1 row-cols-md-4 g-4"></div>
</div>

<!-- Modal -->
<div class="modal fade" id="movieModal">
<div class="modal-dialog modal-dialog-centered">
<div class="modal-content bg-dark text-white p-4">
<div id="modal-body"></div>
</div>
</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
function go() {
const res = document.getElementById("results");
res.innerHTML = "<p class='text-center'>Loading...</p>";

fetch("/recommend", {
method: "POST",
headers: {"Content-Type": "application/json"},
body: JSON.stringify({
movie: movie.value,
type: type.value,
language: language.value,
platform: platform.value
})
})
.then(r => r.json())
.then(data => {
res.innerHTML = "";
if (!data.length) {
res.innerHTML = "<p class='text-center'>No results</p>";
return;
}
data.forEach(m => {
res.innerHTML += `
<div class="col">
<div class="card" onclick="showDetails(this)"
data-title="${m.title}"
data-poster="${m.poster}"
data-genres="${m.genres}"
data-platform="${m.platform}">
<img src="${m.poster}" onerror="this.src='/static/placeholder.jpg'">
<div class="card-body">
<b>${m.title}</b>
<p>${m.genres}</p>
</div>
</div>
</div>`;
});
});
}

function showDetails(card) {
modalBody.innerHTML = `
<img src="${card.dataset.poster}" class="img-fluid mb-3">
<h3>${card.dataset.title}</h3>
<p>${card.dataset.genres}</p>
<span class="badge bg-danger">${card.dataset.platform}</span>
`;
new bootstrap.Modal(movieModal).show();
}
</script>
</body>
</html>
